extends base

block title
    title= config.title

block content
    include _partial/common.pug
    .l-postlist
        each post in page.posts.toArray()
            .l-post
                .p-desc.box
                    .p-pic

                    //- title
                    h1.p-title
                        a(href=url_for(post.path))
                            +title(post)

                    //- description / excerpt / content logic
                    if post.description
                        .p-content
                            != post.description

                    else if post.excerpt
                        .p-content
                            != post.excerpt

                    else if post.content
                        -
                            var cleanContent = post.content.replace(/<\/?[^>]+(>|$)/g, "");

                            var limit = 150;
                            var displayContent = cleanContent.length > limit 
                                ? cleanContent.substring(0, limit) + "..." 
                                : cleanContent;

                        .p-content
                            != displayContent

                    //- readmore
                    p.p-readmore
                        a(href=url_for(post.path))= __("阅读更多 >>")

                +post-meta(post)
    include _partial/paginator.pug
